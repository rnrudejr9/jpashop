
## API
* 엔티티 필드를 바꾸게되면 api 스펙이 바뀌어버리게된다.
* 엔티티를 여러곳에서 사용하기 때문에 필드명을 바뀌어버리게되면 대규모 수정이 일어남
* 회원 정보만 원하는데, 엔티티를 주게되면 원치않는 값들을 주게된다.
* api스펙에 맞춰서 DTO를 사용해서 해결한다
  * DTO를 보면 api 스펙을 볼 수 있다. (가독성 상승) valid 조건 적용가능
  * entity를 외부로 노출하지 않음

#### 회원 등록, 수정, 조회 API 개발 완료  

## API 개발 고급

* 조회용 샘플 데이터 입력
* 지연로딩과 조회 성능 최적화
* 컬렉션 조회 최적화
* 페이징과 한계 돌파
* OSIV와 성능 최적화


## 지연로딩과 조회 성능 최적화
* 주문 + 배송정보 + 회원을 조회하는 api 개발
* 지연로딩 때문에 발생하는 성능문제를 단계적 해결

### 실무 100% 과정

1. 간단한 주문조회 V1 : 엔티티를 직접 노출
2. DTO 로 조회 V2 : N+1 성능문제 발생, 쿼리가 너무많이 나감
3. 페치조인 최적화 V3 : 많은 select 문을 날림 -> **v4 비교해서 성능테스트 미비함!**
4. new 명령어로 DTO로 원하는 데이터만 출력 V4 : 그래프탐색이 없다. , 재사용성이 없다, api 스펙에따라 작성해야됨
5. 

* 엔티티를 DTO 로 변환하거나, DTO 로 바로 조회하는 두가지 방법은 장단점이있음
* 쿼리 방식 선택 권장 순서
  * 우선 엔티티를 DTO 변환하는 방법 선택 (v2)
  * 필요하면 페치 조인으로 성능 최적화 (v3)
  * 그래도 안되면 DTO 직접 조회 방법 사용 (v4)
  * 최후의 방법은 JPA 제공하는 네이티브 SQL 이나 스프링 JDBC Template 사용해서 SQL을 직접 사용한다.


